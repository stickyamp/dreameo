<ion-header [translucent]="true">
  <ion-toolbar class="dream-toolbar">
    <ion-title i18n="@@dreams.title">Sue침os</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="addDream()" fill="clear">
        <ion-icon name="add" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="dream-container">
  <div class="dreams-container">
    <!-- Dreams Header -->
    <div class="dreams-header">
      <h2>{{ getHeaderTitle() }}</h2>
      <p class="dreams-subtitle" *ngIf="recentDreams.length > 0">
        Tus sue침os m치s recientes
      </p>
    </div>

    <!-- Dreams List -->
    <div class="dreams-list" *ngIf="recentDreams.length > 0">
      <div class="dreams-by-date" *ngFor="let group of dreamGroups; trackBy: trackByDate">
        <h3 class="date-header">
          {{ group.date }}
          <div class="moon-icons">
            <ion-icon *ngFor="let dream of getDisplayedDreams(group.dreams)" name="moon" class="header-moon-icon">
            </ion-icon>
            <span *ngIf="group.dreams.length > 5" class="dream-count">
              +{{ group.dreams.length - 5 }}
            </span>
          </div>
        </h3>

        <ion-card *ngFor="let dream of group.dreams; trackBy: trackByDream" class="dream-card"
          (click)="viewDream(dream)">
          <ion-card-content>
            <div class="dream-header">
              <h4 class="dream-title">{{ dream.title }}</h4>
              <div class="dream-icons">
                <span class="dream-type-badge" [class.good]="getDreamType(dream) === 'good'"
                  [class.bad]="getDreamType(dream) === 'bad'">
                  <ion-icon [name]="getDreamTypeIcon(dream)"></ion-icon>
                </span>
                <ion-icon *ngIf="dream.audioPath" name="volume-high" class="audio-icon">
                </ion-icon>
                <ion-icon name="chevron-forward" class="chevron-icon"></ion-icon>
              </div>
            </div>
            <p class="dream-description" *ngIf="dream.description">
              {{ getTruncatedDescription(dream.description) }}
            </p>
            <div class="dream-meta">
              <span class="dream-time">
                <ion-icon name="time" class="time-icon"></ion-icon>
                {{ getFormattedTime(dream.createdAt) }}
              </span>
            </div>
          </ion-card-content>
        </ion-card>
      </div>
    </div>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="recentDreams.length === 0">
      <div class="empty-icon">游깿</div>
      <h3 i18n="@@dreams.no.dreams">No hay sue침os registrados</h3>
      <p i18n="@@dreams.no.dreams.description">Comienza registrando tu primer sue침o</p>
      <ion-button class="dream-button" (click)="addDream()">
        <ion-icon name="add-circle" slot="start"></ion-icon>
        A침adir Sue침o
      </ion-button>
    </div>
  </div>

  <!-- Floating Action Button -->
  <ion-fab slot="fixed" vertical="bottom" horizontal="end" *ngIf="recentDreams.length > 0">
    <ion-button class="fab-dream" (click)="addDream()">
      <ion-icon name="add"></ion-icon>
    </ion-button>
  </ion-fab>
</ion-content>