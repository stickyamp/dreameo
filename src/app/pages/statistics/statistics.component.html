<ion-content [fullscreen]="true">
  <div class="content-wrapper">

    <!-- Period Selection -->
    <div class="period-buttons">
      <ion-button [fill]="selectedPeriod === 'thisWeek' ? 'solid' : 'outline'" (click)="selectPeriod('thisWeek')"
        size="small" class="period-btn">
        This Week
      </ion-button>
      <ion-button [fill]="selectedPeriod === 'thisMonth' ? 'solid' : 'outline'" (click)="selectPeriod('thisMonth')"
        size="small" class="period-btn">
        This Month
      </ion-button>
      <ion-button [fill]="selectedPeriod === 'allTime' ? 'solid' : 'outline'" (click)="selectPeriod('allTime')"
        size="small" class="period-btn">
        All Time
      </ion-button>
    </div>

    <!-- Dream Counts -->
    <div class="stats-grid">
      <ion-card class="stat-card">
        <ion-card-content class="dream-count">
          <div class="stat-header">
            <span class="stat-label">Total Dreams</span>
            <ion-icon name="information-circle-outline" class="info-icon"></ion-icon>
          </div>
          <div class="stat-value">{{ stats.totalDreams }}</div>
        </ion-card-content>
      </ion-card>

      <ion-card class="stat-card">
        <ion-card-content class="dream-count">
          <div class="stat-header">
            <span class="stat-label">Special dreams</span>
            <ion-icon name="information-circle-outline" class="info-icon"></ion-icon>
          </div>
          <div class="stat-value lucid">{{ stats.lucidDreams + stats.nightmares }}</div>
        </ion-card-content>
      </ion-card>
    </div>

    <!-- Dream Frequency Chart -->
    <ion-card class="chart-card">
      <ion-card-content>
        <div class="chart-header">
          <div>
            <div class="chart-title">Dream Frequency</div>
            <div class="chart-subtitle">
              <span class="frequency-number">{{ stats.dreamFrequency }}</span>
              <span class="frequency-label">
                {{ selectedPeriod === 'thisWeek' ? 'This Week' :
                selectedPeriod === 'thisMonth' ? 'This Month' :
                'All Time' }}
              </span>
            </div>
          </div>
          <ion-icon name="information-circle-outline" class="info-icon"></ion-icon>
        </div>

        <div class="chart-legend">
          <div class="legend-item">
            <span class="legend-color lucid"></span>
            <span class="legend-label">Lucid</span>
          </div>
          <div class="legend-item">
            <span class="legend-color normal"></span>
            <span class="legend-label">Normal</span>
          </div>
          <div class="legend-item">
            <span class="legend-color nightmare"></span>
            <span class="legend-label">Nightmare</span>
          </div>
        </div>

        <div class="chart-container">
          <svg class="frequency-chart" viewBox="0 0 240 100" preserveAspectRatio="none">
            <!-- Lucid Dreams Line -->
            <path *ngIf="chartPathLucid" [attr.d]="chartPathLucid" fill="none" stroke="#8B5CF6" stroke-width="1"
              vector-effect="non-scaling-stroke" />
            <!-- Normal Dreams Line -->
            <path *ngIf="chartPathNormal" [attr.d]="chartPathNormal" fill="none" stroke="#5B5FC7" stroke-width="1"
              vector-effect="non-scaling-stroke" />
            <!-- Nightmare Dreams Line -->
            <path *ngIf="chartPathNightmare" [attr.d]="chartPathNightmare" fill="none" stroke="#EF4444" stroke-width="1"
              vector-effect="non-scaling-stroke" />
          </svg>
          <div class="chart-labels">
            <span *ngFor="let label of chartLabels">{{ label }}</span>
          </div>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Most Repeated Keywords -->
    <ion-card class="keywords-card">
      <ion-card-content>
        <div class="section-header">
          <span class="section-title">Most Repeated Keywords</span>
          <ion-icon name="information-circle-outline" class="info-icon"></ion-icon>
        </div>

        <div class="keywords-container">
          <ion-chip *ngFor="let keyword of keywords" class="keyword-chip">
            <ion-label>{{ keyword }}</ion-label>
          </ion-chip>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Dream Types -->
    <ion-card class="types-card">
      <ion-card-content>
        <div class="section-header">
          <span class="section-title">Dream Types</span>
          <ion-icon name="information-circle-outline" class="info-icon"></ion-icon>
        </div>

        <div class="types-list">
          <div *ngFor="let type of dreamTypes" class="type-item">
            <span class="type-label">{{ type.type }}</span>
            <div class="type-bar-container">
              <div class="type-bar" [style.width.%]="stats.totalDreams ? (type.count / stats.totalDreams * 100) : 0"
                [class]="type.type.toLowerCase()"></div>
            </div>
            <span class="type-percentage">{{ type.count }}</span>
          </div>
        </div>
      </ion-card-content>
    </ion-card>

  </div>
</ion-content>